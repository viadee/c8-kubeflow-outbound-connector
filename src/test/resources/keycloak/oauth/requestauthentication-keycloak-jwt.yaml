apiVersion: security.istio.io/v1
kind: RequestAuthentication
metadata:
  name: keycloak-jwt
  namespace: kubeflow
spec:
  jwtRules:
  - issuer: http://localhost/auth/realms/kubeflow
    jwksUri: http://keycloak.keycloak.svc.cluster.local:8080/auth/realms/kubeflow/protocol/openid-connect/certs
    # forwardOriginalToken must be set to true so the authorization header will
    # be passed between Kubeflow Components and Istio can configure the
    # Kubeflow Auth Headers based on this request authorization header.
    forwardOriginalToken: true
    outputClaimToHeaders:
    - header: kubeflow-userid
      claim: email
    - header: kubeflow-groups
      claim: groups